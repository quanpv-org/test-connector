name: Disable README_DE.md

on:
  pull_request:
    paths:
      - "**/README_DE.md"

jobs:
  prevent-modification:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          
      - name: Check if README_DE.md existed on default branch
        run: |
          git fetch origin ${{ github.base_ref }}
          if git ls-tree -r origin/${{ github.base_ref }} --name-only | grep -q 'README_DE\.md$'; then
            echo "README_DE.md exists, checking for modification"
            # Check if file content changed vs. base branch
            if ! git diff --exit-code origin/${{ github.base_ref }}...HEAD -- '**/README_DE.md'; then
              echo "⚠ ERROR: Modification of README_DE.md is not allowed."
              exit 1
            fi
          else
            echo "✓ README_DE.md does not exist on default branch, file can be created."
          fi
